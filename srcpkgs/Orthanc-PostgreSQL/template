# Template file for 'Orthanc-PostgreSQL'
pkgname=Orthanc-PostgreSQL
version=4.0
revision=1
wrksrc="${pkgname/-}-${version}"
build_wrksrc="PostgreSQL"
build_style=cmake
configure_args="-DORTHANC_FRAMEWORK_SOURCE=path
 -DORTHANC_FRAMEWORK_ROOT=/usr/share/orthanc/OrthancFramework/Sources"
hostmakedepends="tar unzip python3"
makedepends="Orthanc-devel openssl-devel gtest-devel zlib-devel
 jsoncpp-devel libuuid-devel boost-devel postgresql-libs-devel"
short_desc="PostgreSQL database plugin for Orthanc"
maintainer="Carlos E. Gallo F. <gcarlos@disroot.org>"
license="AGPL-3.0-or-later"
homepage="https://www.orthanc-server.com/static.php?page=dicomweb"
distfiles="https://www.orthanc-server.com/downloads/get.php?path=/plugin-postgresql/${pkgname/-}-${version}.tar.gz"
checksum=a5049ed8a5d6bb8b6529636cf1d9f631d1b61f6e0bbfdc6accae45aded42bac5
nocross="A package on makedepends (Orthanc-devel) is marked as nocross"

post_install() {
	vlicense ../COPYING

	cd ${DESTDIR}
	mkdir -p usr/lib/orthanc/plugins
	mv usr/share/orthanc/plugins/* usr/lib/orthanc/plugins/
	rm -rf usr/share/orthanc/plugins
}
