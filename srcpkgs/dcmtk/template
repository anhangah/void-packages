# Template file for 'dcmtk'
pkgname=dcmtk
version=3.6.7
revision=1
build_style=cmake
configure_args="-DDCMTK_ENABLE_CXX11=ON -DBUILD_SHARED_LIBS=ON
 -DDCMTK_WITH_DOXYGEN=ON"
hostmakedepends="doxygen"
makedepends="openssl-devel zlib-devel tiff-devel libpng-devel libxml2-devel
 icu-devel"
short_desc="Libraries and tools that implements DICOM standard"
maintainer="Carlos E. Gallo F. <gcarlos@disroot.org>"
license="custom: see /usr/share/licenses/${pkgname}"
homepage="https://dcmtk.org/dcmtk.php.en"
distfiles="https://dicom.offis.de/download/dcmtk/dcmtk${version//.}/dcmtk-${version}.tar.gz"
checksum=7c58298e3e8d60232ee6fc8408cfadd14463cc11a3c4ca4c59af5988c7e9710a
nocross="It's some tricky to achieve cross building, wich needs to compile and
 run some tests codes on the target arch.
 See https://support.dcmtk.org/redmine/projects/dcmtk/wiki/Cross_Compiling"

pre_build() {
	ninja -C build DOXYGEN
}

post_install() {
	vlicense COPYRIGHT
}

dcmtk-doc_package() {
	short_desc+=' - documentation'
	pkg_install() {
		vmove usr/share/doc
	}
}

# TODO need license here
libdcmtk_package() {
	short_desc+=' - runtime libraries'
	pkg_install() {
		vmove "usr/lib/*.so.*"
		vmove usr/share/dcmtk
	}
}

libdcmtk-devel_package() {
	short_desc+=' - development files'
	depends="lib${sourcepkg}>=${version}_${revision}"
	pkg_install() {
		vmove usr/include
		vmove usr/lib/pkgconfig
		vmove usr/lib/cmake
		vmove "usr/lib/*.so"
	}
}
